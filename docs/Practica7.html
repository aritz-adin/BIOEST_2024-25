<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Aritz Adin">
<meta name="dcterms.date" content="2024-11-12">

<title>BIOEST 2024-25 - Práctica 7: Análisis de Supervivencia</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">BIOEST 2024-25</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Programa</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./Practica0.html" rel="" target="">
 <span class="menu-text">Práctica 0</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./Practica1.html" rel="" target="">
 <span class="menu-text">Práctica 1</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./Practica2.html" rel="" target="">
 <span class="menu-text">Práctica 2</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./Practica3.html" rel="" target="">
 <span class="menu-text">Práctica 3</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./Practica4.html" rel="" target="">
 <span class="menu-text">Práctica 4</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./Practica5.html" rel="" target="">
 <span class="menu-text">Práctica 5</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./Practica6.html" rel="" target="">
 <span class="menu-text">Práctica 6</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./Practica7.html" rel="" target="" aria-current="page">
 <span class="menu-text">Práctica 7</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#ejercicio-1" id="toc-ejercicio-1" class="nav-link active" data-scroll-target="#ejercicio-1">Ejercicio 1</a>
  <ul class="collapse">
  <li><a href="#introduce-los-datos-manualmente-en-r-o-lee-el-fichero-dispositivo.txt." id="toc-introduce-los-datos-manualmente-en-r-o-lee-el-fichero-dispositivo.txt." class="nav-link" data-scroll-target="#introduce-los-datos-manualmente-en-r-o-lee-el-fichero-dispositivo.txt.">1.1. Introduce los datos manualmente en R o lee el fichero <code>dispositivo.txt</code>.</a></li>
  <li><a href="#estima-la-función-de-supervivencia-st-por-kaplan-meier.-calcula-los-errores-estándar-y-proporciona-un-i.c.-al-95-para-st." id="toc-estima-la-función-de-supervivencia-st-por-kaplan-meier.-calcula-los-errores-estándar-y-proporciona-un-i.c.-al-95-para-st." class="nav-link" data-scroll-target="#estima-la-función-de-supervivencia-st-por-kaplan-meier.-calcula-los-errores-estándar-y-proporciona-un-i.c.-al-95-para-st.">1.2. Estima la función de supervivencia <span class="math inline">\(S(t)\)</span> por Kaplan-Meier. Calcula los errores estándar y proporciona un I.C. al 95% para <span class="math inline">\(S(t)\)</span>.</a></li>
  <li><a href="#dibuja-la-función-de-supervivencia-estimada-con-su-correspondiente-intervalo-de-confianza." id="toc-dibuja-la-función-de-supervivencia-estimada-con-su-correspondiente-intervalo-de-confianza." class="nav-link" data-scroll-target="#dibuja-la-función-de-supervivencia-estimada-con-su-correspondiente-intervalo-de-confianza.">1.3. Dibuja la función de supervivencia estimada con su correspondiente intervalo de confianza.</a></li>
  <li><a href="#cuál-es-la-probabilidad-de-que-el-tiempo-de-uso-del-dispositivo-supere-las-19-semanas-proporciona-los-correspondientes-intervalos-de-confianza-al-95-e-interpreta-su-significado." id="toc-cuál-es-la-probabilidad-de-que-el-tiempo-de-uso-del-dispositivo-supere-las-19-semanas-proporciona-los-correspondientes-intervalos-de-confianza-al-95-e-interpreta-su-significado." class="nav-link" data-scroll-target="#cuál-es-la-probabilidad-de-que-el-tiempo-de-uso-del-dispositivo-supere-las-19-semanas-proporciona-los-correspondientes-intervalos-de-confianza-al-95-e-interpreta-su-significado.">1.4. ¿Cuál es la probabilidad de que el tiempo de uso del dispositivo supere las 19 semanas? Proporciona los correspondientes intervalos de confianza al 95% e interpreta su significado.</a></li>
  <li><a href="#a-partir-de-qué-semana-la-supervivencia-es-menor-al-80" id="toc-a-partir-de-qué-semana-la-supervivencia-es-menor-al-80" class="nav-link" data-scroll-target="#a-partir-de-qué-semana-la-supervivencia-es-menor-al-80">1.5. ¿A partir de qué semana la supervivencia es menor al 80%?</a></li>
  </ul></li>
  <li><a href="#ejercicio-2" id="toc-ejercicio-2" class="nav-link" data-scroll-target="#ejercicio-2">Ejercicio 2</a>
  <ul class="collapse">
  <li><a href="#estima-curvas-de-supervivencia-por-el-método-de-kaplan-y-meier-para-los-distintos-grupos-del-tratamiento.-crees-que-existen-diferencias-entre-las-curvas" id="toc-estima-curvas-de-supervivencia-por-el-método-de-kaplan-y-meier-para-los-distintos-grupos-del-tratamiento.-crees-que-existen-diferencias-entre-las-curvas" class="nav-link" data-scroll-target="#estima-curvas-de-supervivencia-por-el-método-de-kaplan-y-meier-para-los-distintos-grupos-del-tratamiento.-crees-que-existen-diferencias-entre-las-curvas">1.1. Estima curvas de supervivencia por el método de Kaplan y Meier para los distintos grupos del tratamiento. ¿Crees que existen diferencias entre las curvas?</a></li>
  <li><a href="#comprueba-si-las-diferencias-observadas-en-las-curvas-son-o-no-estadísticamente-significativas-utilizando-el-test-de-log-rank-y-el-test-de-peto-peto." id="toc-comprueba-si-las-diferencias-observadas-en-las-curvas-son-o-no-estadísticamente-significativas-utilizando-el-test-de-log-rank-y-el-test-de-peto-peto." class="nav-link" data-scroll-target="#comprueba-si-las-diferencias-observadas-en-las-curvas-son-o-no-estadísticamente-significativas-utilizando-el-test-de-log-rank-y-el-test-de-peto-peto.">1.2. Comprueba si las diferencias observadas en las curvas son o no estadísticamente significativas utilizando el test de Log-Rank y el test de Peto-Peto.</a></li>
  <li><a href="#cuál-es-la-probabilidad-que-un-individuo-del-grupo-lev5fu-viva-más-de-127-días-proporciona-un-intervalo-de-confianza-al-95-para-dicha-probabilidad." id="toc-cuál-es-la-probabilidad-que-un-individuo-del-grupo-lev5fu-viva-más-de-127-días-proporciona-un-intervalo-de-confianza-al-95-para-dicha-probabilidad." class="nav-link" data-scroll-target="#cuál-es-la-probabilidad-que-un-individuo-del-grupo-lev5fu-viva-más-de-127-días-proporciona-un-intervalo-de-confianza-al-95-para-dicha-probabilidad.">1.3. ¿Cuál es la probabilidad que un individuo del grupo “Lev+5FU” viva más de 127 días? Proporciona un intervalo de confianza al 95% para dicha probabilidad.</a></li>
  <li><a href="#estima-curvas-de-supervivencia-por-el-método-de-kaplan-y-meier-según-el-sexo.-crees-que-existen-diferencias-entre-las-curvas" id="toc-estima-curvas-de-supervivencia-por-el-método-de-kaplan-y-meier-según-el-sexo.-crees-que-existen-diferencias-entre-las-curvas" class="nav-link" data-scroll-target="#estima-curvas-de-supervivencia-por-el-método-de-kaplan-y-meier-según-el-sexo.-crees-que-existen-diferencias-entre-las-curvas">1.4. Estima curvas de supervivencia por el método de Kaplan y Meier según el sexo. ¿Crees que existen diferencias entre las curvas?</a></li>
  <li><a href="#estima-curvas-de-supervivencia-por-el-método-de-kaplan-y-meier-según-si-el-tumor-se-diferencia-bien-moderadamente-o-mal.-crees-que-existen-diferencias-entre-las-curvas" id="toc-estima-curvas-de-supervivencia-por-el-método-de-kaplan-y-meier-según-si-el-tumor-se-diferencia-bien-moderadamente-o-mal.-crees-que-existen-diferencias-entre-las-curvas" class="nav-link" data-scroll-target="#estima-curvas-de-supervivencia-por-el-método-de-kaplan-y-meier-según-si-el-tumor-se-diferencia-bien-moderadamente-o-mal.-crees-que-existen-diferencias-entre-las-curvas">1.5. Estima curvas de supervivencia por el método de Kaplan y Meier según si el tumor se diferencia bien, moderadamente o mal. ¿Crees que existen diferencias entre las curvas?</a></li>
  <li><a href="#estima-curvas-de-supervivencia-por-el-método-de-kaplan-y-meier-según-la-extensión-del-tumor.-crees-que-existen-diferencias-entre-las-curvas" id="toc-estima-curvas-de-supervivencia-por-el-método-de-kaplan-y-meier-según-la-extensión-del-tumor.-crees-que-existen-diferencias-entre-las-curvas" class="nav-link" data-scroll-target="#estima-curvas-de-supervivencia-por-el-método-de-kaplan-y-meier-según-la-extensión-del-tumor.-crees-que-existen-diferencias-entre-las-curvas">1.6. Estima curvas de supervivencia por el método de Kaplan y Meier según la extensión del tumor. ¿Crees que existen diferencias entre las curvas?</a></li>
  <li><a href="#estima-curvas-de-supervivencia-por-el-método-de-kaplan-y-meier-a-partir-de-los-siguientes-valores-de-la-variable-edad-grupo-1-1845-grupo-2-4565-y-grupo-3-65.-crees-que-existen-diferencias-entre-las-curvas" id="toc-estima-curvas-de-supervivencia-por-el-método-de-kaplan-y-meier-a-partir-de-los-siguientes-valores-de-la-variable-edad-grupo-1-1845-grupo-2-4565-y-grupo-3-65.-crees-que-existen-diferencias-entre-las-curvas" class="nav-link" data-scroll-target="#estima-curvas-de-supervivencia-por-el-método-de-kaplan-y-meier-a-partir-de-los-siguientes-valores-de-la-variable-edad-grupo-1-1845-grupo-2-4565-y-grupo-3-65.-crees-que-existen-diferencias-entre-las-curvas">1.7. Estima curvas de supervivencia por el método de Kaplan y Meier a partir de los siguientes valores de la variable edad: grupo 1 [18,45], grupo 2 (45,65] y grupo 3 (65,+]. ¿Crees que existen diferencias entre las curvas?</a></li>
  </ul></li>
  <li><a href="#para-entregar" id="toc-para-entregar" class="nav-link" data-scroll-target="#para-entregar">Para entregar</a>
  <ul class="collapse">
  <li><a href="#estima-curvas-de-supervivencia-por-el-método-de-kaplan-y-meier-para-los-grupos-standard-y-test-del-tratamiento.-son-las-curvas-significativamente-distintas" id="toc-estima-curvas-de-supervivencia-por-el-método-de-kaplan-y-meier-para-los-grupos-standard-y-test-del-tratamiento.-son-las-curvas-significativamente-distintas" class="nav-link" data-scroll-target="#estima-curvas-de-supervivencia-por-el-método-de-kaplan-y-meier-para-los-grupos-standard-y-test-del-tratamiento.-son-las-curvas-significativamente-distintas">1.1. Estima curvas de supervivencia por el método de Kaplan y Meier para los grupos standard y test del tratamiento. ¿Son las curvas significativamente distintas?</a></li>
  <li><a href="#cuál-es-la-supervivencia-en-el-instante-13-para-los-distintos-grupos-qué-significa" id="toc-cuál-es-la-supervivencia-en-el-instante-13-para-los-distintos-grupos-qué-significa" class="nav-link" data-scroll-target="#cuál-es-la-supervivencia-en-el-instante-13-para-los-distintos-grupos-qué-significa">1.2. ¿Cuál es la supervivencia en el instante 13 para los distintos grupos? ¿Qué significa?</a></li>
  <li><a href="#estima-curvas-de-supervivencia-por-el-método-de-kaplan-y-meier-a-partir-de-los-siguientes-valores-de-la-variable-karnofsky-grupo-1-0-50-años-grupo-2-50-70-y-grupo-3-70-100." id="toc-estima-curvas-de-supervivencia-por-el-método-de-kaplan-y-meier-a-partir-de-los-siguientes-valores-de-la-variable-karnofsky-grupo-1-0-50-años-grupo-2-50-70-y-grupo-3-70-100." class="nav-link" data-scroll-target="#estima-curvas-de-supervivencia-por-el-método-de-kaplan-y-meier-a-partir-de-los-siguientes-valores-de-la-variable-karnofsky-grupo-1-0-50-años-grupo-2-50-70-y-grupo-3-70-100.">1.3. Estima curvas de supervivencia por el método de Kaplan y Meier a partir de los siguientes valores de la variable Karnofsky: grupo 1 (0-50] años, grupo 2 (50-70] y grupo 3 (70-100].</a></li>
  <li><a href="#comprueba-si-las-diferencias-observadas-en-las-curvas-son-o-no-estadísticamente-significativas-utilizando-el-test-de-log-rank-y-el-test-de-peto-peto.-alpha0.05" id="toc-comprueba-si-las-diferencias-observadas-en-las-curvas-son-o-no-estadísticamente-significativas-utilizando-el-test-de-log-rank-y-el-test-de-peto-peto.-alpha0.05" class="nav-link" data-scroll-target="#comprueba-si-las-diferencias-observadas-en-las-curvas-son-o-no-estadísticamente-significativas-utilizando-el-test-de-log-rank-y-el-test-de-peto-peto.-alpha0.05">1.4. Comprueba si las diferencias observadas en las curvas son o no estadísticamente significativas utilizando el test de Log-Rank y el test de Peto-Peto. <span class="math inline">\(\alpha=0.05\)</span></a></li>
  <li><a href="#cuál-es-la-probabilidad-de-supervivencia-para-el-grupo-1-0-50-en-el-día-24-y-en-el-grupo-2-5070.-proporciona-un-intervalo-de-confianza-al-95-para-dichas-probabilidades." id="toc-cuál-es-la-probabilidad-de-supervivencia-para-el-grupo-1-0-50-en-el-día-24-y-en-el-grupo-2-5070.-proporciona-un-intervalo-de-confianza-al-95-para-dichas-probabilidades." class="nav-link" data-scroll-target="#cuál-es-la-probabilidad-de-supervivencia-para-el-grupo-1-0-50-en-el-día-24-y-en-el-grupo-2-5070.-proporciona-un-intervalo-de-confianza-al-95-para-dichas-probabilidades.">1.5 ¿Cuál es la probabilidad de supervivencia para el grupo 1 (0-50] en el día 24? ¿Y en el grupo 2 (50,70]?. Proporciona un intervalo de confianza al 95% para dichas probabilidades.</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Práctica 7: Análisis de Supervivencia</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Aritz Adin </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">11/12/2024</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="ejercicio-1" class="level2">
<h2 class="anchored" data-anchor-id="ejercicio-1">Ejercicio 1</h2>
<p>En pruebas con anticonceptivos, un criterio evidente de aceptación de dicho anticonceptivo es la prevención de embarazos. Sin embargo, los anticonceptivos modernos muestran tasas de fallo muy bajas, y por tanto las alteraciones en ocurrencia de hemorragias, como amenorrea (una ausencia prolongada de hemorragia), hemorragias irregulares o prolongadas, son importantes a la hora de evaluar un método anticonceptivo.</p>
<p>Para promocionar la investigación en este tema la OMS (WHO) ha proporcionado datos de ensayos clínicos realizadas con distintos tipos de anticonceptivos. Una parte de este conjunto de datos tiene que ver con el tiempo que transcurre desde que una mujer comienza a usar un método particular hasta que suspende su uso.</p>
<p>Los datos que presentamos a continuación corresponden al número de semanas que transcurren desde el comienzo de uso de un dispositivo intrauterino particular (DIU) llamado Multiload 250, hasta que se suspende su uso por problemas de hemorragias. Los datos corresponden a 18 mujeres entre 18 y 35 años que habían experimentado dos embarazos previos.</p>
<p>En este ejemplo el tiempo de origen en que se comienza el estudio es a partir del primer día de uso del DIU y el tiempo final es la suspensión debido a problemas hemorrágicos.</p>
<p>Algunas mujeres suspendieron el uso del DIU porque deseaban quedarse embarazadas mientras que otras simplemente se perdió su seguimiento. Por ello aparecen algunos datos censurados.</p>
<p>Un objetivo de este análisis es <strong>resumir la distribución de los tiempos de suspensión del uso del dispositivo intrauterino</strong>.</p>
<p><strong>Datos</strong>: Tiempo en semanas hasta la suspensión de uso del DIU</p>
<p>10, 13+, 18+, 19, 23+, 30, 36, 38+, 54+ 56+, 59, 75, 93, 97, 104+, 107, 107+, 107+</p>
<p>Responde a las siguientes preguntas:</p>
<section id="introduce-los-datos-manualmente-en-r-o-lee-el-fichero-dispositivo.txt." class="level3">
<h3 class="anchored" data-anchor-id="introduce-los-datos-manualmente-en-r-o-lee-el-fichero-dispositivo.txt.">1.1. Introduce los datos manualmente en R o lee el fichero <code>dispositivo.txt</code>.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>diu <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"dispositivo.txt"</span>, <span class="at">header=</span>T)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(diu)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   time status
1    10      1
2    13      0
3    18      0
4    19      1
5    23      0
6    30      1
7    36      1
8    38      0
9    54      0
10   56      0
11   59      1
12   75      1
13   93      1
14   97      1
15  104      0
16  107      1
17  107      0
18  107      0</code></pre>
</div>
</div>
</section>
<section id="estima-la-función-de-supervivencia-st-por-kaplan-meier.-calcula-los-errores-estándar-y-proporciona-un-i.c.-al-95-para-st." class="level3">
<h3 class="anchored" data-anchor-id="estima-la-función-de-supervivencia-st-por-kaplan-meier.-calcula-los-errores-estándar-y-proporciona-un-i.c.-al-95-para-st.">1.2. Estima la función de supervivencia <span class="math inline">\(S(t)\)</span> por Kaplan-Meier. Calcula los errores estándar y proporciona un I.C. al 95% para <span class="math inline">\(S(t)\)</span>.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Intervalo de confianza "curva +- error estandar" ##</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>diu.surv1 <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(time,status)<span class="sc">~</span><span class="dv">1</span>, diu, <span class="at">conf.type=</span><span class="st">"plain"</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(diu.surv1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call: survfit(formula = Surv(time, status) ~ 1, data = diu, conf.type = "plain")

 time n.risk n.event survival std.err lower 95% CI upper 95% CI
   10     18       1    0.944  0.0540       0.8386        1.000
   19     15       1    0.881  0.0790       0.7267        1.000
   30     13       1    0.814  0.0978       0.6220        1.000
   36     12       1    0.746  0.1107       0.5290        0.963
   59      8       1    0.653  0.1303       0.3972        0.908
   75      7       1    0.559  0.1412       0.2827        0.836
   93      6       1    0.466  0.1452       0.1816        0.751
   97      5       1    0.373  0.1430       0.0927        0.653
  107      3       1    0.249  0.1392       0.0000        0.522</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Intervalo de confianza con la transformación clog-log ##</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>diu.surv2 <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(time,status)<span class="sc">~</span><span class="dv">1</span>, diu, <span class="at">conf.type=</span><span class="st">"log-log"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(diu.surv2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call: survfit(formula = Surv(time, status) ~ 1, data = diu, conf.type = "log-log")

 time n.risk n.event survival std.err lower 95% CI upper 95% CI
   10     18       1    0.944  0.0540       0.6664        0.992
   19     15       1    0.881  0.0790       0.6019        0.969
   30     13       1    0.814  0.0978       0.5241        0.936
   36     12       1    0.746  0.1107       0.4536        0.897
   59      8       1    0.653  0.1303       0.3438        0.843
   75      7       1    0.559  0.1412       0.2564        0.780
   93      6       1    0.466  0.1452       0.1830        0.710
   97      5       1    0.373  0.1430       0.1209        0.631
  107      3       1    0.249  0.1392       0.0468        0.531</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Intervalo de confianza aplicando logaritmos (por defecto) ##</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>diu.surv3 <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(time,status)<span class="sc">~</span><span class="dv">1</span>, diu)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(diu.surv3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call: survfit(formula = Surv(time, status) ~ 1, data = diu)

 time n.risk n.event survival std.err lower 95% CI upper 95% CI
   10     18       1    0.944  0.0540       0.8443        1.000
   19     15       1    0.881  0.0790       0.7395        1.000
   30     13       1    0.814  0.0978       0.6429        1.000
   36     12       1    0.746  0.1107       0.5577        0.998
   59      8       1    0.653  0.1303       0.4413        0.965
   75      7       1    0.559  0.1412       0.3411        0.917
   93      6       1    0.466  0.1452       0.2532        0.858
   97      5       1    0.373  0.1430       0.1759        0.791
  107      3       1    0.249  0.1392       0.0829        0.745</code></pre>
</div>
</div>
</section>
<section id="dibuja-la-función-de-supervivencia-estimada-con-su-correspondiente-intervalo-de-confianza." class="level3">
<h3 class="anchored" data-anchor-id="dibuja-la-función-de-supervivencia-estimada-con-su-correspondiente-intervalo-de-confianza.">1.3. Dibuja la función de supervivencia estimada con su correspondiente intervalo de confianza.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(diu.surv1, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">main=</span><span class="st">"Función supervivencia por Kaplan-Meier"</span>, <span class="at">xlab=</span><span class="st">"Tiempo (semanas)"</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(diu.surv2, <span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(diu.surv3, <span class="at">col=</span><span class="st">"black"</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomleft"</span>, <span class="fu">c</span>(<span class="st">"Surv1"</span>,<span class="st">"Surv2"</span>,<span class="st">"Surv3"</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">"red"</span>,<span class="st">"blue"</span>,<span class="st">"black"</span>), <span class="at">lty=</span><span class="dv">2</span>, <span class="at">bty=</span><span class="st">"n"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Practica7_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="cuál-es-la-probabilidad-de-que-el-tiempo-de-uso-del-dispositivo-supere-las-19-semanas-proporciona-los-correspondientes-intervalos-de-confianza-al-95-e-interpreta-su-significado." class="level3">
<h3 class="anchored" data-anchor-id="cuál-es-la-probabilidad-de-que-el-tiempo-de-uso-del-dispositivo-supere-las-19-semanas-proporciona-los-correspondientes-intervalos-de-confianza-al-95-e-interpreta-su-significado.">1.4. ¿Cuál es la probabilidad de que el tiempo de uso del dispositivo supere las 19 semanas? Proporciona los correspondientes intervalos de confianza al 95% e interpreta su significado.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>aux <span class="ot">&lt;-</span> <span class="fu">summary</span>(diu.surv3)[<span class="fu">c</span>(<span class="st">"time"</span>,<span class="st">"n.risk"</span>,<span class="st">"n.event"</span>,<span class="st">"surv"</span>,<span class="st">"std.err"</span>,<span class="st">"lower"</span>,<span class="st">"upper"</span>)]</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>aux <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(aux)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>aux[aux<span class="sc">$</span>time<span class="sc">==</span><span class="st">"19"</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  time n.risk n.event      surv    std.err     lower upper
2   19     15       1 0.8814815 0.07898919 0.7394986     1</code></pre>
</div>
</div>
<p><strong>INTERPRETACIÓN</strong>: …</p>
<!-- La probabilidad de que el tiempo de uso del dispositivo supere las 19 semanas es de 0.8815 con un intervalo de confianza al 95\% de $[0.7395, 1]$. -->
</section>
<section id="a-partir-de-qué-semana-la-supervivencia-es-menor-al-80" class="level3">
<h3 class="anchored" data-anchor-id="a-partir-de-qué-semana-la-supervivencia-es-menor-al-80">1.5. ¿A partir de qué semana la supervivencia es menor al 80%?</h3>
<!-- A partir de la semana 36 la supervivencia es menor al 80%. Sin embargo, mirando el intervalo de confianza vemos que no contiene al 0.8 a partir de la semana 97. -->
</section>
</section>
<section id="ejercicio-2" class="level2">
<h2 class="anchored" data-anchor-id="ejercicio-2">Ejercicio 2</h2>
<p>El fichero <code>colon.txt</code> contiene los resultados de un experimento en 929 pacientes con cáncer de colon en estado B/C que se les suministra quimioterapia adyuvante. Algunas de las variables que recoge el fichero son</p>
<ul>
<li><code>time</code>: tiempo de supervivencia en días</li>
<li><code>status</code>: variable que mide el fallo (1) o la censura (0)</li>
<li><code>rx</code>: tratamiento. “Obs”, “Lev” (Levamisole), “Lev+5FU” (Levamisole +5-FU)</li>
<li><code>sex</code>: male (1) o female (0)</li>
<li><code>age</code>: edad en años</li>
<li><code>differ</code>: diferenciación del tumor (1=bien, 2=moderadamente, 3=mal)</li>
<li><code>extent</code>: extensión local (1=submucosa, 2=músculo, 3=serosa, 4=estructuras contiguas)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>colon <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"colon.txt"</span>, <span class="at">header=</span>T, <span class="at">stringsAsFactors=</span>T)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(colon)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   929 obs. of  8 variables:
 $ id    : int  1 2 3 4 5 6 7 8 9 10 ...
 $ time  : int  1521 3087 963 293 659 1767 420 3192 3173 3308 ...
 $ status: int  1 0 1 1 1 1 1 0 0 0 ...
 $ rx    : Factor w/ 3 levels "Lev","Lev+5FU",..: 2 2 3 2 3 2 1 3 1 2 ...
 $ sex   : int  1 1 0 0 1 0 1 1 1 0 ...
 $ age   : int  43 63 71 66 69 57 77 54 46 68 ...
 $ differ: int  2 2 2 2 2 2 2 2 2 2 ...
 $ extent: int  3 3 2 3 3 3 3 3 3 3 ...</code></pre>
</div>
</div>
<section id="estima-curvas-de-supervivencia-por-el-método-de-kaplan-y-meier-para-los-distintos-grupos-del-tratamiento.-crees-que-existen-diferencias-entre-las-curvas" class="level3">
<h3 class="anchored" data-anchor-id="estima-curvas-de-supervivencia-por-el-método-de-kaplan-y-meier-para-los-distintos-grupos-del-tratamiento.-crees-que-existen-diferencias-entre-las-curvas">1.1. Estima curvas de supervivencia por el método de Kaplan y Meier para los distintos grupos del tratamiento. ¿Crees que existen diferencias entre las curvas?</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>colon.surv <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(time, status) <span class="sc">~</span> rx, <span class="at">data=</span>colon)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(colon.surv, <span class="at">col=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">main=</span><span class="st">"Curvas de supervivencia KM"</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomleft"</span>, <span class="fu">levels</span>(colon<span class="sc">$</span>rx), <span class="at">col=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">bty=</span><span class="st">"n"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Practica7_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>La curva de supervivencia correspondiente al tratamiento “Lev+5FU” está consistentemente por encima de las otras dos curvas (“Lev” y “Lev+5FU”), por lo que el pronóstico de supervivencia es mejor en este grupo que en el resto. Sin embargo, parece no observarse diferencias entre las curvas de supervivencia de los grupos “Lev” y “Obs”.</p>
</section>
<section id="comprueba-si-las-diferencias-observadas-en-las-curvas-son-o-no-estadísticamente-significativas-utilizando-el-test-de-log-rank-y-el-test-de-peto-peto." class="level3">
<h3 class="anchored" data-anchor-id="comprueba-si-las-diferencias-observadas-en-las-curvas-son-o-no-estadísticamente-significativas-utilizando-el-test-de-log-rank-y-el-test-de-peto-peto.">1.2. Comprueba si las diferencias observadas en las curvas son o no estadísticamente significativas utilizando el test de Log-Rank y el test de Peto-Peto.</h3>
<p>Test Log-Rank</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">survdiff</span>(<span class="fu">Surv</span>(time,status)<span class="sc">~</span>rx, colon) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
survdiff(formula = Surv(time, status) ~ rx, data = colon)

             N Observed Expected (O-E)^2/E (O-E)^2/V
rx=Lev     310      161      146      1.52      2.25
rx=Lev+5FU 304      123      157      7.55     11.62
rx=Obs     315      168      148      2.58      3.85

 Chisq= 11.7  on 2 degrees of freedom, p= 0.003 </code></pre>
</div>
</div>
<p>Test Peto-Peto</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">survdiff</span>(<span class="fu">Surv</span>(time,status)<span class="sc">~</span>rx, <span class="at">rho=</span><span class="dv">1</span>, colon)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
survdiff(formula = Surv(time, status) ~ rx, data = colon, rho = 1)

             N Observed Expected (O-E)^2/E (O-E)^2/V
rx=Lev     310    122.8      111      1.26      2.38
rx=Lev+5FU 304     93.1      118      5.24     10.27
rx=Obs     315    126.0      113      1.50      2.86

 Chisq= 10.3  on 2 degrees of freedom, p= 0.006 </code></pre>
</div>
</div>
<p>En ambos casos, rechazamos la hipótesis nula de que las curvas de superviviencia KM son iguales para los tres grupos.</p>
</section>
<section id="cuál-es-la-probabilidad-que-un-individuo-del-grupo-lev5fu-viva-más-de-127-días-proporciona-un-intervalo-de-confianza-al-95-para-dicha-probabilidad." class="level3">
<h3 class="anchored" data-anchor-id="cuál-es-la-probabilidad-que-un-individuo-del-grupo-lev5fu-viva-más-de-127-días-proporciona-un-intervalo-de-confianza-al-95-para-dicha-probabilidad.">1.3. ¿Cuál es la probabilidad que un individuo del grupo “Lev+5FU” viva más de 127 días? Proporciona un intervalo de confianza al 95% para dicha probabilidad.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>aux <span class="ot">&lt;-</span> <span class="fu">summary</span>(colon.surv)[<span class="fu">c</span>(<span class="st">"strata"</span>,<span class="st">"time"</span>,<span class="st">"n.risk"</span>,<span class="st">"n.event"</span>,<span class="st">"surv"</span>,<span class="st">"std.err"</span>,<span class="st">"lower"</span>,<span class="st">"upper"</span>)]</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>aux <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(aux)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>aux <span class="ot">&lt;-</span> aux[aux<span class="sc">$</span>strata<span class="sc">==</span><span class="st">"rx=Lev+5FU"</span>,]</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(aux, <span class="at">n=</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        strata time n.risk n.event      surv     std.err     lower     upper
155 rx=Lev+5FU   23    304       1 0.9967105 0.003284059 0.9902946 1.0000000
156 rx=Lev+5FU   34    303       1 0.9934211 0.004636690 0.9843747 1.0000000
157 rx=Lev+5FU   45    302       1 0.9901316 0.005669353 0.9790820 1.0000000
158 rx=Lev+5FU   52    301       1 0.9868421 0.006535521 0.9741155 0.9997350
159 rx=Lev+5FU   79    300       1 0.9835526 0.007294747 0.9693586 0.9979545
160 rx=Lev+5FU  127    299       1 0.9802632 0.007977621 0.9647513 0.9960244
161 rx=Lev+5FU  138    298       1 0.9769737 0.008602345 0.9602580 0.9939803
162 rx=Lev+5FU  141    297       1 0.9736842 0.009180799 0.9558554 0.9918455
163 rx=Lev+5FU  144    296       1 0.9703947 0.009721245 0.9515273 0.9896363
164 rx=Lev+5FU  186    295       1 0.9671053 0.010229709 0.9472618 0.9873644</code></pre>
</div>
</div>
<p><strong>INTERPRETACIÓN</strong>: …</p>
<!-- La probabilidad de que un individuo del grupo "Lev+5FU" viva más de 127 días es de 0.9803 con un intervalo de confianza al 95\% de $[0.9648, 0.996]$. -->
</section>
<section id="estima-curvas-de-supervivencia-por-el-método-de-kaplan-y-meier-según-el-sexo.-crees-que-existen-diferencias-entre-las-curvas" class="level3">
<h3 class="anchored" data-anchor-id="estima-curvas-de-supervivencia-por-el-método-de-kaplan-y-meier-según-el-sexo.-crees-que-existen-diferencias-entre-las-curvas">1.4. Estima curvas de supervivencia por el método de Kaplan y Meier según el sexo. ¿Crees que existen diferencias entre las curvas?</h3>
</section>
<section id="estima-curvas-de-supervivencia-por-el-método-de-kaplan-y-meier-según-si-el-tumor-se-diferencia-bien-moderadamente-o-mal.-crees-que-existen-diferencias-entre-las-curvas" class="level3">
<h3 class="anchored" data-anchor-id="estima-curvas-de-supervivencia-por-el-método-de-kaplan-y-meier-según-si-el-tumor-se-diferencia-bien-moderadamente-o-mal.-crees-que-existen-diferencias-entre-las-curvas">1.5. Estima curvas de supervivencia por el método de Kaplan y Meier según si el tumor se diferencia bien, moderadamente o mal. ¿Crees que existen diferencias entre las curvas?</h3>
</section>
<section id="estima-curvas-de-supervivencia-por-el-método-de-kaplan-y-meier-según-la-extensión-del-tumor.-crees-que-existen-diferencias-entre-las-curvas" class="level3">
<h3 class="anchored" data-anchor-id="estima-curvas-de-supervivencia-por-el-método-de-kaplan-y-meier-según-la-extensión-del-tumor.-crees-que-existen-diferencias-entre-las-curvas">1.6. Estima curvas de supervivencia por el método de Kaplan y Meier según la extensión del tumor. ¿Crees que existen diferencias entre las curvas?</h3>
</section>
<section id="estima-curvas-de-supervivencia-por-el-método-de-kaplan-y-meier-a-partir-de-los-siguientes-valores-de-la-variable-edad-grupo-1-1845-grupo-2-4565-y-grupo-3-65.-crees-que-existen-diferencias-entre-las-curvas" class="level3">
<h3 class="anchored" data-anchor-id="estima-curvas-de-supervivencia-por-el-método-de-kaplan-y-meier-a-partir-de-los-siguientes-valores-de-la-variable-edad-grupo-1-1845-grupo-2-4565-y-grupo-3-65.-crees-que-existen-diferencias-entre-las-curvas">1.7. Estima curvas de supervivencia por el método de Kaplan y Meier a partir de los siguientes valores de la variable edad: grupo 1 [18,45], grupo 2 (45,65] y grupo 3 (65,+]. ¿Crees que existen diferencias entre las curvas?</h3>
<p>En primer lugar definimos la nueva variable:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>colon<span class="sc">$</span>grupo <span class="ot">&lt;-</span> <span class="fu">cut</span>(colon<span class="sc">$</span>age, <span class="at">include.lowest=</span><span class="cn">TRUE</span>, <span class="at">right=</span><span class="cn">TRUE</span>,</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">18</span>,<span class="dv">45</span>,<span class="dv">65</span>,<span class="fu">max</span>(colon<span class="sc">$</span>age)),</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"grupo 1"</span>,<span class="st">"grupo 2"</span>,<span class="st">"grupo 3"</span>))</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(colon<span class="sc">$</span>grupo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>grupo 1 grupo 2 grupo 3 
    124     471     334 </code></pre>
</div>
</div>
<p>A continuación, estimamos las curvas de supervivencia por el método KM y comprobamos si existen diferencias significativas entre los grupos de edad:</p>
</section>
</section>
<section id="para-entregar" class="level2">
<h2 class="anchored" data-anchor-id="para-entregar">Para entregar</h2>
<p>Disponemos de 137 pacientes con cancer de pulmón. Los datos se encuentran en el fichero <code>VA</code> de la librería <code>MASS</code>. La variable respuesta es el tiempo de supervivencia en días. El fichero tiene las siguientes variables:</p>
<ul>
<li><code>stime</code>: tiempo de supervivencia en días</li>
<li><code>status</code>: variable que mide el fallo (1) o la censura (0)</li>
<li><code>treat</code>: tratamiento standard (1) o test (2)</li>
<li><code>cell</code>: cuatro tipos distintos de células (1=squamous, 2=smallcell, 3=adeno, 4=large)</li>
<li><code>Karn</code>: puntuación Karnofsky medido en una escala de 0-100, con valores altos para pacientes que se encuentran relativamente bien</li>
<li><code>diag.time</code>: Tiempo en meses desde el diagnóstico al entrar en la prueba</li>
<li><code>age</code>: edad en años</li>
<li><code>prior</code>: variable lógica que determina si hubo terapia a priori (0=no, 10=yes)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"VA"</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(VA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   137 obs. of  8 variables:
 $ stime    : num  72 411 228 126 118 10 82 110 314 100 ...
 $ status   : num  1 1 1 1 1 1 1 1 1 0 ...
 $ treat    : Factor w/ 2 levels "1","2": 1 1 1 1 1 1 1 1 1 1 ...
 $ age      : num  69 64 38 63 65 49 69 68 43 70 ...
 $ Karn     : num  60 70 60 60 70 20 40 80 50 70 ...
 $ diag.time: num  7 5 3 9 11 5 10 29 18 6 ...
 $ cell     : Factor w/ 4 levels "1","2","3","4": 1 1 1 1 1 1 1 1 1 1 ...
 $ prior    : Factor w/ 2 levels "0","10": 1 2 1 2 2 1 2 1 1 1 ...</code></pre>
</div>
</div>
<p>Responde a las siguientes preguntas:</p>
<section id="estima-curvas-de-supervivencia-por-el-método-de-kaplan-y-meier-para-los-grupos-standard-y-test-del-tratamiento.-son-las-curvas-significativamente-distintas" class="level3">
<h3 class="anchored" data-anchor-id="estima-curvas-de-supervivencia-por-el-método-de-kaplan-y-meier-para-los-grupos-standard-y-test-del-tratamiento.-son-las-curvas-significativamente-distintas">1.1. Estima curvas de supervivencia por el método de Kaplan y Meier para los grupos standard y test del tratamiento. ¿Son las curvas significativamente distintas?</h3>
</section>
<section id="cuál-es-la-supervivencia-en-el-instante-13-para-los-distintos-grupos-qué-significa" class="level3">
<h3 class="anchored" data-anchor-id="cuál-es-la-supervivencia-en-el-instante-13-para-los-distintos-grupos-qué-significa">1.2. ¿Cuál es la supervivencia en el instante 13 para los distintos grupos? ¿Qué significa?</h3>
</section>
<section id="estima-curvas-de-supervivencia-por-el-método-de-kaplan-y-meier-a-partir-de-los-siguientes-valores-de-la-variable-karnofsky-grupo-1-0-50-años-grupo-2-50-70-y-grupo-3-70-100." class="level3">
<h3 class="anchored" data-anchor-id="estima-curvas-de-supervivencia-por-el-método-de-kaplan-y-meier-a-partir-de-los-siguientes-valores-de-la-variable-karnofsky-grupo-1-0-50-años-grupo-2-50-70-y-grupo-3-70-100.">1.3. Estima curvas de supervivencia por el método de Kaplan y Meier a partir de los siguientes valores de la variable Karnofsky: grupo 1 (0-50] años, grupo 2 (50-70] y grupo 3 (70-100].</h3>
</section>
<section id="comprueba-si-las-diferencias-observadas-en-las-curvas-son-o-no-estadísticamente-significativas-utilizando-el-test-de-log-rank-y-el-test-de-peto-peto.-alpha0.05" class="level3">
<h3 class="anchored" data-anchor-id="comprueba-si-las-diferencias-observadas-en-las-curvas-son-o-no-estadísticamente-significativas-utilizando-el-test-de-log-rank-y-el-test-de-peto-peto.-alpha0.05">1.4. Comprueba si las diferencias observadas en las curvas son o no estadísticamente significativas utilizando el test de Log-Rank y el test de Peto-Peto. <span class="math inline">\(\alpha=0.05\)</span></h3>
</section>
<section id="cuál-es-la-probabilidad-de-supervivencia-para-el-grupo-1-0-50-en-el-día-24-y-en-el-grupo-2-5070.-proporciona-un-intervalo-de-confianza-al-95-para-dichas-probabilidades." class="level3">
<h3 class="anchored" data-anchor-id="cuál-es-la-probabilidad-de-supervivencia-para-el-grupo-1-0-50-en-el-día-24-y-en-el-grupo-2-5070.-proporciona-un-intervalo-de-confianza-al-95-para-dichas-probabilidades.">1.5 ¿Cuál es la probabilidad de supervivencia para el grupo 1 (0-50] en el día 24? ¿Y en el grupo 2 (50,70]?. Proporciona un intervalo de confianza al 95% para dichas probabilidades.</h3>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script>
</div> <!-- /content -->



</body></html>